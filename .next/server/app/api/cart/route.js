"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/cart/route";
exports.ids = ["app/api/cart/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcart%2Froute&page=%2Fapi%2Fcart%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcart%2Froute.ts&appDir=%2FUsers%2Fnikitakozlenko%2FDocuments%2Fgithub%2Fnext-pizza%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fnikitakozlenko%2FDocuments%2Fgithub%2Fnext-pizza&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcart%2Froute&page=%2Fapi%2Fcart%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcart%2Froute.ts&appDir=%2FUsers%2Fnikitakozlenko%2FDocuments%2Fgithub%2Fnext-pizza%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fnikitakozlenko%2FDocuments%2Fgithub%2Fnext-pizza&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_nikitakozlenko_Documents_github_next_pizza_app_api_cart_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/cart/route.ts */ \"(rsc)/./app/api/cart/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/cart/route\",\n        pathname: \"/api/cart\",\n        filename: \"route\",\n        bundlePath: \"app/api/cart/route\"\n    },\n    resolvedPagePath: \"/Users/nikitakozlenko/Documents/github/next-pizza/app/api/cart/route.ts\",\n    nextConfigOutput,\n    userland: _Users_nikitakozlenko_Documents_github_next_pizza_app_api_cart_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/cart/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjYXJ0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjYXJ0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2FydCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRm5pa2l0YWtvemxlbmtvJTJGRG9jdW1lbnRzJTJGZ2l0aHViJTJGbmV4dC1waXp6YSUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZuaWtpdGFrb3psZW5rbyUyRkRvY3VtZW50cyUyRmdpdGh1YiUyRm5leHQtcGl6emEmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ3VCO0FBQ3BHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV4dC1waXp6YS8/NTdkNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvbmlraXRha296bGVua28vRG9jdW1lbnRzL2dpdGh1Yi9uZXh0LXBpenphL2FwcC9hcGkvY2FydC9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvY2FydC9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2NhcnRcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2NhcnQvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvbmlraXRha296bGVua28vRG9jdW1lbnRzL2dpdGh1Yi9uZXh0LXBpenphL2FwcC9hcGkvY2FydC9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvY2FydC9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcart%2Froute&page=%2Fapi%2Fcart%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcart%2Froute.ts&appDir=%2FUsers%2Fnikitakozlenko%2FDocuments%2Fgithub%2Fnext-pizza%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fnikitakozlenko%2FDocuments%2Fgithub%2Fnext-pizza&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/cart/route.ts":
/*!*******************************!*\
  !*** ./app/api/cart/route.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/db */ \"(rsc)/./db.ts\");\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _lib_find_or_create_cart__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/find-or-create-cart */ \"(rsc)/./lib/find-or-create-cart.ts\");\n/* harmony import */ var _lib_update_cart_total_amount__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/update-cart-total-amount */ \"(rsc)/./lib/update-cart-total-amount.ts\");\n\n\n\n\n\nasync function GET(req) {\n    try {\n        const token = req.cookies.get(\"cartToken\")?.value;\n        if (!token) return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n            items: []\n        });\n        const userCart = await _db__WEBPACK_IMPORTED_MODULE_0__[\"default\"].cart.findFirst({\n            where: {\n                OR: [\n                    {\n                        userId: token\n                    },\n                    {\n                        token\n                    }\n                ]\n            },\n            include: {\n                cartItem: {\n                    orderBy: {\n                        createdAt: \"desc\"\n                    },\n                    include: {\n                        productItem: {\n                            include: {\n                                product: true\n                            }\n                        },\n                        ingredients: true\n                    }\n                }\n            }\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json(userCart);\n    } catch (error) {\n        console.error(\"Error fetching items for cart:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n            error: \"Failed to fetch items for cart\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function POST(req) {\n    try {\n        let token = req.cookies.get(\"cartToken\")?.value;\n        if (!token) token = crypto__WEBPACK_IMPORTED_MODULE_2___default().randomUUID();\n        const data = await req.json();\n        const userCart = await (0,_lib_find_or_create_cart__WEBPACK_IMPORTED_MODULE_3__.findOrCreateCart)(token);\n        const findCartItem = await _db__WEBPACK_IMPORTED_MODULE_0__[\"default\"].cartItem.findFirst({\n            where: {\n                cartId: userCart.id,\n                ingredients: {\n                    every: {\n                        id: {\n                            in: data.ingredients\n                        }\n                    }\n                },\n                productItemId: data.productItemId\n            }\n        });\n        if (findCartItem) {\n            await _db__WEBPACK_IMPORTED_MODULE_0__[\"default\"].cartItem.update({\n                where: {\n                    id: findCartItem.id\n                },\n                data: {\n                    quantity: ++findCartItem.quantity\n                }\n            });\n        } else {\n            await _db__WEBPACK_IMPORTED_MODULE_0__[\"default\"].cartItem.create({\n                data: {\n                    cartId: userCart.id,\n                    quantity: 1,\n                    ingredients: {\n                        connect: data.ingredients?.map((id)=>({\n                                id\n                            }))\n                    },\n                    productItemId: data.productItemId\n                }\n            });\n        }\n        const updateUserCart = await (0,_lib_update_cart_total_amount__WEBPACK_IMPORTED_MODULE_4__.updateCartTotalAmount)(token);\n        const res = next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json(updateUserCart, {\n            status: 200\n        });\n        res.cookies.set(\"cartToken\", token);\n        return res;\n    } catch (error) {\n        console.error(\"Error when creating or adding an item to cart\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_1__.NextResponse.json({\n            error: \"Error when creating or adding an item to cart\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RSxRQUFRO1FBQUk7SUFDckc7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL25leHQtcGl6emEvLi9hcHAvYXBpL2NhcnQvcm91dGUudHM/YzIxNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcHJpc21hIGZyb20gXCJAL2RiXCI7XHJcbmltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcclxuaW1wb3J0IGNyeXB0byBmcm9tIFwiY3J5cHRvXCI7XHJcbmltcG9ydCB7IGZpbmRPckNyZWF0ZUNhcnQgfSBmcm9tIFwiQC9saWIvZmluZC1vci1jcmVhdGUtY2FydFwiO1xyXG5pbXBvcnQgeyBDcmVhdGVDYXJ0SXRlbVZhbHVlcyB9IGZyb20gXCJAL3NlcnZpY2VzL2R0by9jYXJ0LmR0b1wiO1xyXG5pbXBvcnQgeyB1cGRhdGVDYXJ0VG90YWxBbW91bnQgfSBmcm9tIFwiQC9saWIvdXBkYXRlLWNhcnQtdG90YWwtYW1vdW50XCI7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcTogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgdG9rZW4gPSByZXEuY29va2llcy5nZXQoXCJjYXJ0VG9rZW5cIik/LnZhbHVlO1xyXG5cclxuICAgIGlmICghdG9rZW4pIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGl0ZW1zOiBbXSB9KTtcclxuXHJcbiAgICBjb25zdCB1c2VyQ2FydCA9IGF3YWl0IHByaXNtYS5jYXJ0LmZpbmRGaXJzdCh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgT1I6IFtcclxuICAgICAgICAgIHsgdXNlcklkOiB0b2tlbiB9LFxyXG4gICAgICAgICAgeyB0b2tlbiB9XHJcbiAgICAgICAgXVxyXG4gICAgICB9LFxyXG4gICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgY2FydEl0ZW06IHtcclxuICAgICAgICAgIG9yZGVyQnk6IHtcclxuICAgICAgICAgICAgY3JlYXRlZEF0OiBcImRlc2NcIixcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgICAgIHByb2R1Y3RJdGVtOiB7XHJcbiAgICAgICAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgICAgICAgcHJvZHVjdDogdHJ1ZSxcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGluZ3JlZGllbnRzOiB0cnVlLFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24odXNlckNhcnQpXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBpdGVtcyBmb3IgY2FydDpcIiwgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiRmFpbGVkIHRvIGZldGNoIGl0ZW1zIGZvciBjYXJ0XCIgfSwgeyBzdGF0dXM6IDUwMCB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcTogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgbGV0IHRva2VuID0gcmVxLmNvb2tpZXMuZ2V0KFwiY2FydFRva2VuXCIpPy52YWx1ZTtcclxuICAgIGlmICghdG9rZW4pIHRva2VuID0gY3J5cHRvLnJhbmRvbVVVSUQoKTtcclxuXHJcbiAgICBjb25zdCBkYXRhID0gKGF3YWl0IHJlcS5qc29uKCkpIGFzIENyZWF0ZUNhcnRJdGVtVmFsdWVzO1xyXG4gICAgY29uc3QgdXNlckNhcnQgPSBhd2FpdCBmaW5kT3JDcmVhdGVDYXJ0KHRva2VuKTtcclxuXHJcbiAgICBjb25zdCBmaW5kQ2FydEl0ZW0gPSBhd2FpdCBwcmlzbWEuY2FydEl0ZW0uZmluZEZpcnN0KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBjYXJ0SWQ6IHVzZXJDYXJ0LmlkLFxyXG4gICAgICAgIGluZ3JlZGllbnRzOiB7XHJcbiAgICAgICAgICBldmVyeToge1xyXG4gICAgICAgICAgICBpZDogeyBpbjogZGF0YS5pbmdyZWRpZW50cyB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBwcm9kdWN0SXRlbUlkOiBkYXRhLnByb2R1Y3RJdGVtSWQsXHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgaWYgKGZpbmRDYXJ0SXRlbSkge1xyXG4gICAgICBhd2FpdCBwcmlzbWEuY2FydEl0ZW0udXBkYXRlKHtcclxuICAgICAgICB3aGVyZToge1xyXG4gICAgICAgICAgaWQ6IGZpbmRDYXJ0SXRlbS5pZCxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIHF1YW50aXR5OiArK2ZpbmRDYXJ0SXRlbS5xdWFudGl0eSxcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBhd2FpdCBwcmlzbWEuY2FydEl0ZW0uY3JlYXRlKHtcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICBjYXJ0SWQ6IHVzZXJDYXJ0LmlkLFxyXG4gICAgICAgICAgcXVhbnRpdHk6IDEsXHJcbiAgICAgICAgICBpbmdyZWRpZW50czoge1xyXG4gICAgICAgICAgICBjb25uZWN0OiBkYXRhLmluZ3JlZGllbnRzPy5tYXAoaWQgPT4gKHsgaWQgfSkpXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgcHJvZHVjdEl0ZW1JZDogZGF0YS5wcm9kdWN0SXRlbUlkXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB1cGRhdGVVc2VyQ2FydCA9IGF3YWl0IHVwZGF0ZUNhcnRUb3RhbEFtb3VudCh0b2tlbik7XHJcbiAgICBjb25zdCByZXMgPSBOZXh0UmVzcG9uc2UuanNvbih1cGRhdGVVc2VyQ2FydCwgeyBzdGF0dXM6IDIwMCB9KVxyXG5cclxuICAgIHJlcy5jb29raWVzLnNldChcImNhcnRUb2tlblwiLCB0b2tlbik7XHJcbiAgICByZXR1cm4gcmVzO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igd2hlbiBjcmVhdGluZyBvciBhZGRpbmcgYW4gaXRlbSB0byBjYXJ0XCIsIGVycm9yKVxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiRXJyb3Igd2hlbiBjcmVhdGluZyBvciBhZGRpbmcgYW4gaXRlbSB0byBjYXJ0XCIgfSwgeyBzdGF0dXM6IDUwMCB9KVxyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJwcmlzbWEiLCJOZXh0UmVzcG9uc2UiLCJjcnlwdG8iLCJmaW5kT3JDcmVhdGVDYXJ0IiwidXBkYXRlQ2FydFRvdGFsQW1vdW50IiwiR0VUIiwicmVxIiwidG9rZW4iLCJjb29raWVzIiwiZ2V0IiwidmFsdWUiLCJqc29uIiwiaXRlbXMiLCJ1c2VyQ2FydCIsImNhcnQiLCJmaW5kRmlyc3QiLCJ3aGVyZSIsIk9SIiwidXNlcklkIiwiaW5jbHVkZSIsImNhcnRJdGVtIiwib3JkZXJCeSIsImNyZWF0ZWRBdCIsInByb2R1Y3RJdGVtIiwicHJvZHVjdCIsImluZ3JlZGllbnRzIiwiZXJyb3IiLCJjb25zb2xlIiwic3RhdHVzIiwiUE9TVCIsInJhbmRvbVVVSUQiLCJkYXRhIiwiZmluZENhcnRJdGVtIiwiY2FydElkIiwiaWQiLCJldmVyeSIsImluIiwicHJvZHVjdEl0ZW1JZCIsInVwZGF0ZSIsInF1YW50aXR5IiwiY3JlYXRlIiwiY29ubmVjdCIsIm1hcCIsInVwZGF0ZVVzZXJDYXJ0IiwicmVzIiwic2V0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/cart/route.ts\n");

/***/ }),

/***/ "(rsc)/./db.ts":
/*!***************!*\
  !*** ./db.ts ***!
  \***************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst prismaClientSingleton = ()=>{\n    return new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\n};\nconst prisma = globalThis.prismaGlobal ?? prismaClientSingleton();\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (prisma);\nif (true) globalThis.prismaGlobal = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9kYi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBNkM7QUFFN0MsTUFBTUMsd0JBQXdCO0lBQzVCLE9BQU8sSUFBSUQsd0RBQVlBO0FBQ3pCO0FBTUEsTUFBTUUsU0FBU0MsV0FBV0MsWUFBWSxJQUFJSDtBQUUxQyxpRUFBZUMsTUFBTUEsRUFBQTtBQUVyQixJQUFJRyxJQUF5QixFQUFjRixXQUFXQyxZQUFZLEdBQUdGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV4dC1waXp6YS8uL2RiLnRzP2M0OGQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnXHJcblxyXG5jb25zdCBwcmlzbWFDbGllbnRTaW5nbGV0b24gPSAoKSA9PiB7XHJcbiAgcmV0dXJuIG5ldyBQcmlzbWFDbGllbnQoKVxyXG59XHJcblxyXG5kZWNsYXJlIGNvbnN0IGdsb2JhbFRoaXM6IHtcclxuICBwcmlzbWFHbG9iYWw6IFJldHVyblR5cGU8dHlwZW9mIHByaXNtYUNsaWVudFNpbmdsZXRvbj47XHJcbn0gJiB0eXBlb2YgZ2xvYmFsO1xyXG5cclxuY29uc3QgcHJpc21hID0gZ2xvYmFsVGhpcy5wcmlzbWFHbG9iYWwgPz8gcHJpc21hQ2xpZW50U2luZ2xldG9uKClcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHByaXNtYVxyXG5cclxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIGdsb2JhbFRoaXMucHJpc21hR2xvYmFsID0gcHJpc21hIl0sIm5hbWVzIjpbIlByaXNtYUNsaWVudCIsInByaXNtYUNsaWVudFNpbmdsZXRvbiIsInByaXNtYSIsImdsb2JhbFRoaXMiLCJwcmlzbWFHbG9iYWwiLCJwcm9jZXNzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./db.ts\n");

/***/ }),

/***/ "(rsc)/./lib/calc-cart-item-total-price.ts":
/*!*******************************************!*\
  !*** ./lib/calc-cart-item-total-price.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   calcCartItemTotalPrice: () => (/* binding */ calcCartItemTotalPrice)\n/* harmony export */ });\nconst calcCartItemTotalPrice = (cartItem)=>{\n    const ingredientsPrice = cartItem.ingredients.reduce((acc, ingredient)=>acc + ingredient.price, 0);\n    return (ingredientsPrice + cartItem.productItem.price) * cartItem.quantity;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvY2FsYy1jYXJ0LWl0ZW0tdG90YWwtcHJpY2UudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUdPLE1BQU1BLHlCQUF5QixDQUFDQztJQUNyQyxNQUFNQyxtQkFBbUJELFNBQVNFLFdBQVcsQ0FBQ0MsTUFBTSxDQUFDLENBQUNDLEtBQUtDLGFBQWVELE1BQU1DLFdBQVdDLEtBQUssRUFBRTtJQUVsRyxPQUFPLENBQUNMLG1CQUFtQkQsU0FBU08sV0FBVyxDQUFDRCxLQUFLLElBQUlOLFNBQVNRLFFBQVE7QUFDNUUsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL25leHQtcGl6emEvLi9saWIvY2FsYy1jYXJ0LWl0ZW0tdG90YWwtcHJpY2UudHM/NzE0MyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDYXJ0SXRlbUR0byB9IGZyb20gXCJAL3NlcnZpY2VzL2R0by9jYXJ0LmR0b1wiO1xyXG5pbXBvcnQgeyBDYXJ0SXRlbSwgSW5ncmVkaWVudCwgUHJvZHVjdCwgUHJvZHVjdEl0ZW0gfSBmcm9tIFwiQHByaXNtYS9jbGllbnRcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBjYWxjQ2FydEl0ZW1Ub3RhbFByaWNlID0gKGNhcnRJdGVtOiBDYXJ0SXRlbUR0byk6IG51bWJlciA9PiB7XHJcbiAgY29uc3QgaW5ncmVkaWVudHNQcmljZSA9IGNhcnRJdGVtLmluZ3JlZGllbnRzLnJlZHVjZSgoYWNjLCBpbmdyZWRpZW50KSA9PiBhY2MgKyBpbmdyZWRpZW50LnByaWNlLCAwKTtcclxuXHJcbiAgcmV0dXJuIChpbmdyZWRpZW50c1ByaWNlICsgY2FydEl0ZW0ucHJvZHVjdEl0ZW0ucHJpY2UpICogY2FydEl0ZW0ucXVhbnRpdHk7XHJcbn07Il0sIm5hbWVzIjpbImNhbGNDYXJ0SXRlbVRvdGFsUHJpY2UiLCJjYXJ0SXRlbSIsImluZ3JlZGllbnRzUHJpY2UiLCJpbmdyZWRpZW50cyIsInJlZHVjZSIsImFjYyIsImluZ3JlZGllbnQiLCJwcmljZSIsInByb2R1Y3RJdGVtIiwicXVhbnRpdHkiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/calc-cart-item-total-price.ts\n");

/***/ }),

/***/ "(rsc)/./lib/find-or-create-cart.ts":
/*!************************************!*\
  !*** ./lib/find-or-create-cart.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   findOrCreateCart: () => (/* binding */ findOrCreateCart)\n/* harmony export */ });\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/db */ \"(rsc)/./db.ts\");\n\nconst findOrCreateCart = async (token)=>{\n    let userCart = await _db__WEBPACK_IMPORTED_MODULE_0__[\"default\"].cart.findFirst({\n        where: {\n            token\n        }\n    });\n    if (!userCart) {\n        userCart = await _db__WEBPACK_IMPORTED_MODULE_0__[\"default\"].cart.create({\n            data: {\n                token\n            }\n        });\n    }\n    return userCart;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZmluZC1vci1jcmVhdGUtY2FydC50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUF5QjtBQUVsQixNQUFNQyxtQkFBbUIsT0FBT0M7SUFDckMsSUFBSUMsV0FBVyxNQUFNSCwyQ0FBTUEsQ0FBQ0ksSUFBSSxDQUFDQyxTQUFTLENBQUM7UUFDekNDLE9BQU87WUFDTEo7UUFDRjtJQUNGO0lBRUEsSUFBSSxDQUFDQyxVQUFVO1FBQ2JBLFdBQVcsTUFBTUgsMkNBQU1BLENBQUNJLElBQUksQ0FBQ0csTUFBTSxDQUFDO1lBQ2xDQyxNQUFNO2dCQUNKTjtZQUNGO1FBQ0Y7SUFDRjtJQUVBLE9BQU9DO0FBQ1QsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL25leHQtcGl6emEvLi9saWIvZmluZC1vci1jcmVhdGUtY2FydC50cz82NDU5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwcmlzbWEgZnJvbSBcIkAvZGJcIlxyXG5cclxuZXhwb3J0IGNvbnN0IGZpbmRPckNyZWF0ZUNhcnQgPSBhc3luYyAodG9rZW46IHN0cmluZykgPT4ge1xyXG4gIGxldCB1c2VyQ2FydCA9IGF3YWl0IHByaXNtYS5jYXJ0LmZpbmRGaXJzdCh7XHJcbiAgICB3aGVyZToge1xyXG4gICAgICB0b2tlbixcclxuICAgIH0sXHJcbiAgfSk7XHJcblxyXG4gIGlmICghdXNlckNhcnQpIHtcclxuICAgIHVzZXJDYXJ0ID0gYXdhaXQgcHJpc21hLmNhcnQuY3JlYXRlKHtcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIHRva2VuXHJcbiAgICAgIH0sXHJcbiAgICB9KVxyXG4gIH07XHJcblxyXG4gIHJldHVybiB1c2VyQ2FydDtcclxufSJdLCJuYW1lcyI6WyJwcmlzbWEiLCJmaW5kT3JDcmVhdGVDYXJ0IiwidG9rZW4iLCJ1c2VyQ2FydCIsImNhcnQiLCJmaW5kRmlyc3QiLCJ3aGVyZSIsImNyZWF0ZSIsImRhdGEiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/find-or-create-cart.ts\n");

/***/ }),

/***/ "(rsc)/./lib/update-cart-total-amount.ts":
/*!*****************************************!*\
  !*** ./lib/update-cart-total-amount.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   updateCartTotalAmount: () => (/* binding */ updateCartTotalAmount)\n/* harmony export */ });\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/db */ \"(rsc)/./db.ts\");\n/* harmony import */ var _calc_cart_item_total_price__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./calc-cart-item-total-price */ \"(rsc)/./lib/calc-cart-item-total-price.ts\");\n\n\nconst updateCartTotalAmount = async (token)=>{\n    const userCart = await _db__WEBPACK_IMPORTED_MODULE_0__[\"default\"].cart.findFirst({\n        where: {\n            token\n        },\n        include: {\n            cartItem: {\n                orderBy: {\n                    createdAt: \"desc\"\n                },\n                include: {\n                    ingredients: true,\n                    productItem: {\n                        include: {\n                            product: true\n                        }\n                    }\n                }\n            }\n        }\n    });\n    if (!userCart) throw new Error(\"User cart not found\");\n    const totalAmount = userCart.cartItem.reduce((acc, item)=>{\n        return acc + (0,_calc_cart_item_total_price__WEBPACK_IMPORTED_MODULE_1__.calcCartItemTotalPrice)(item);\n    }, 0);\n    return await _db__WEBPACK_IMPORTED_MODULE_0__[\"default\"].cart.update({\n        where: {\n            id: userCart.id\n        },\n        data: {\n            totalAmount\n        },\n        include: {\n            cartItem: {\n                orderBy: {\n                    createdAt: \"desc\"\n                },\n                include: {\n                    ingredients: true,\n                    productItem: {\n                        include: {\n                            product: true\n                        }\n                    }\n                }\n            }\n        }\n    });\n};\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvdXBkYXRlLWNhcnQtdG90YWwtYW1vdW50LnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF5QjtBQUM2QztBQUV0RSxNQUFNRSx3QkFBd0IsT0FBT0M7SUFDbkMsTUFBTUMsV0FBVyxNQUFNSiwyQ0FBTUEsQ0FBQ0ssSUFBSSxDQUFDQyxTQUFTLENBQUM7UUFDM0NDLE9BQU87WUFDTEo7UUFDRjtRQUNBSyxTQUFTO1lBQ1BDLFVBQVU7Z0JBQ1JDLFNBQVM7b0JBQ1BDLFdBQVc7Z0JBQ2I7Z0JBQ0FILFNBQVM7b0JBQ1BJLGFBQWE7b0JBQ2JDLGFBQWE7d0JBQ1hMLFNBQVM7NEJBQ1BNLFNBQVM7d0JBQ1g7b0JBQ0Y7Z0JBQ0Y7WUFDRjtRQUNGO0lBQ0Y7SUFFQSxJQUFJLENBQUNWLFVBQVUsTUFBTSxJQUFJVyxNQUFNO0lBRS9CLE1BQU1DLGNBQWNaLFNBQVNLLFFBQVEsQ0FBQ1EsTUFBTSxDQUFDLENBQUNDLEtBQUtDO1FBQ2pELE9BQU9ELE1BQU1qQixtRkFBc0JBLENBQUNrQjtJQUN0QyxHQUFHO0lBRUgsT0FBTyxNQUFNbkIsMkNBQU1BLENBQUNLLElBQUksQ0FBQ2UsTUFBTSxDQUFDO1FBQzlCYixPQUFPO1lBQ0xjLElBQUlqQixTQUFTaUIsRUFBRTtRQUNqQjtRQUNBQyxNQUFNO1lBQ0pOO1FBQ0Y7UUFDQVIsU0FBUztZQUNQQyxVQUFVO2dCQUNSQyxTQUFTO29CQUNQQyxXQUFXO2dCQUNiO2dCQUNBSCxTQUFTO29CQUNQSSxhQUFhO29CQUNiQyxhQUFhO3dCQUNYTCxTQUFTOzRCQUNQTSxTQUFTO3dCQUNYO29CQUNGO2dCQUNGO1lBQ0Y7UUFDRjtJQUNGO0FBQ0Y7QUFFZ0MiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXh0LXBpenphLy4vbGliL3VwZGF0ZS1jYXJ0LXRvdGFsLWFtb3VudC50cz81MzgyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwcmlzbWEgZnJvbSBcIkAvZGJcIlxyXG5pbXBvcnQgeyBjYWxjQ2FydEl0ZW1Ub3RhbFByaWNlIH0gZnJvbSBcIi4vY2FsYy1jYXJ0LWl0ZW0tdG90YWwtcHJpY2VcIjtcclxuXHJcbmNvbnN0IHVwZGF0ZUNhcnRUb3RhbEFtb3VudCA9IGFzeW5jICh0b2tlbjogc3RyaW5nKSA9PiB7XHJcbiAgY29uc3QgdXNlckNhcnQgPSBhd2FpdCBwcmlzbWEuY2FydC5maW5kRmlyc3Qoe1xyXG4gICAgd2hlcmU6IHtcclxuICAgICAgdG9rZW4sXHJcbiAgICB9LFxyXG4gICAgaW5jbHVkZToge1xyXG4gICAgICBjYXJ0SXRlbToge1xyXG4gICAgICAgIG9yZGVyQnk6IHtcclxuICAgICAgICAgIGNyZWF0ZWRBdDogJ2Rlc2MnLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgaW5ncmVkaWVudHM6IHRydWUsXHJcbiAgICAgICAgICBwcm9kdWN0SXRlbToge1xyXG4gICAgICAgICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgICAgICAgcHJvZHVjdDogdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgfSk7XHJcblxyXG4gIGlmICghdXNlckNhcnQpIHRocm93IG5ldyBFcnJvcihcIlVzZXIgY2FydCBub3QgZm91bmRcIik7XHJcblxyXG4gIGNvbnN0IHRvdGFsQW1vdW50ID0gdXNlckNhcnQuY2FydEl0ZW0ucmVkdWNlKChhY2MsIGl0ZW0pID0+IHtcclxuICAgIHJldHVybiBhY2MgKyBjYWxjQ2FydEl0ZW1Ub3RhbFByaWNlKGl0ZW0pO1xyXG4gIH0sIDApO1xyXG5cclxuICByZXR1cm4gYXdhaXQgcHJpc21hLmNhcnQudXBkYXRlKHtcclxuICAgIHdoZXJlOiB7XHJcbiAgICAgIGlkOiB1c2VyQ2FydC5pZFxyXG4gICAgfSxcclxuICAgIGRhdGE6IHtcclxuICAgICAgdG90YWxBbW91bnQsXHJcbiAgICB9LFxyXG4gICAgaW5jbHVkZToge1xyXG4gICAgICBjYXJ0SXRlbToge1xyXG4gICAgICAgIG9yZGVyQnk6IHtcclxuICAgICAgICAgIGNyZWF0ZWRBdDogJ2Rlc2MnLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgICAgaW5ncmVkaWVudHM6IHRydWUsXHJcbiAgICAgICAgICBwcm9kdWN0SXRlbToge1xyXG4gICAgICAgICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgICAgICAgcHJvZHVjdDogdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgIH1cclxuICB9KVxyXG59XHJcblxyXG5leHBvcnQgeyB1cGRhdGVDYXJ0VG90YWxBbW91bnQgfSJdLCJuYW1lcyI6WyJwcmlzbWEiLCJjYWxjQ2FydEl0ZW1Ub3RhbFByaWNlIiwidXBkYXRlQ2FydFRvdGFsQW1vdW50IiwidG9rZW4iLCJ1c2VyQ2FydCIsImNhcnQiLCJmaW5kRmlyc3QiLCJ3aGVyZSIsImluY2x1ZGUiLCJjYXJ0SXRlbSIsIm9yZGVyQnkiLCJjcmVhdGVkQXQiLCJpbmdyZWRpZW50cyIsInByb2R1Y3RJdGVtIiwicHJvZHVjdCIsIkVycm9yIiwidG90YWxBbW91bnQiLCJyZWR1Y2UiLCJhY2MiLCJpdGVtIiwidXBkYXRlIiwiaWQiLCJkYXRhIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/update-cart-total-amount.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcart%2Froute&page=%2Fapi%2Fcart%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcart%2Froute.ts&appDir=%2FUsers%2Fnikitakozlenko%2FDocuments%2Fgithub%2Fnext-pizza%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fnikitakozlenko%2FDocuments%2Fgithub%2Fnext-pizza&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();